var canvas=document.querySelector(".game-area__ctx"),ctx=canvas.getContext("2d"),panelWalls=document.querySelector(".game-panel__walls"),draggableWall=null;const getSelectedWall=()=>walls.find(e=>!0===e.active),getDraggableWall=()=>walls.find(e=>!0===e.draggable),currArea={x:50,y:50,width:150,height:150,x1:this.x+this.width,x2:this.y+this.height};let walls=[];const getXcoords=e=>currArea.x+e.x,getYcoords=e=>currArea.y+e.y;canvas.onmousedown=(e=>{walls.forEach(a=>{e.layerX>getXcoords(a)&&e.layerX<getXcoords(a)+a.w?(a.active=!0,a.draggable=!0):a.active=!1}),loadWalls()}),canvas.onmousemove=(e=>{const a=getDraggableWall();if(a){let l=e.layerX-currArea.x-a.w/2,t=e.layerY-currArea.y-a.h/2;l<0&&(l=0),l>=currArea.x+currArea.width&&(l=currArea.x+currArea.width),t<0&&(t=0),t>=currArea.y+currArea.height&&(t=currArea.y+currArea.height),a.x=l,a.y=t,loadWalls()}}),document.onmouseup=(e=>{const a=getDraggableWall();a&&(a.draggable=null)});const setSelectedWall=e=>{walls.forEach(a=>{+e.id===a.id?a.active=!0:a.active=!1}),loadWalls()},wallChange=e=>{console.log(e),walls.find(e=>!0===e.active)[e.name]=+e.value,loadWalls()},addWall=e=>{walls.find(a=>a.id===e.id)||(walls.push(e),panelWalls.insertAdjacentHTML("beforeend",`<div \n        class="game-panel__wall game-panel-wall"\n        id="wall-${e.id}"r\n        onclick="setSelectedWall(this)"\n    >\n        <div class="game-panel-wall__coords">\n            <span classname="game-panel">x:</span>\n            <input name="x" oninput="wallChange(this)" value="${e.x}">\n            <span>y:</span>\n            <input name="y" oninput="wallChange(this)" value="${e.y}">\n        </div>\n        <div class="game-panel-wall__size">\n            <span>width:</span>\n            <input  oninput="wallChange(this)" name="w" value="${e.w}">\n            <span>height:</span>\n            <input oninput="wallChange(this)" name="h" value="${e.h}">\n        </div>\n    </div>`))},updatePanel=e=>{const a=document.querySelector(`#wall-${e.id}`);for(let l in e)a.querySelector(`input[name=${l}]`)&&(console.log(1),a.querySelector(`input[name=${l}]`).innerHTML=e[l])},updateArea=e=>{ctx.beginPath(),addWall(e),ctx.rect(getXcoords(e),getYcoords(e),e.w,e.h),e.active&&(ctx.strokeStyle="red",ctx.lineWidth=5,ctx.stroke()),ctx.fill(),ctx.closePath()},loadWalls=()=>{ctx.clearRect(0,0,canvas.width,canvas.height),walls.map(e=>updateArea(e))};updateArea({x:0,y:0,w:15,h:50,id:1}),updateArea({x:50,y:50,w:15,h:50,id:2});const moveWallKey=e=>{let a=getSelectedWall();if(a)switch(e.code){case"KeyD":case"ArrowRight":a.x+=1;break;case"KeyA":case"ArrowLeft":a.x-=1;break;case"KeyS":case"ArrowDown":a.y+=1;break;case"KeyW":case"ArrowUp":a.y-=1}updatePanel(a),loadWalls()};document.addEventListener("keydown",moveWallKey);